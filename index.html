<!DOCTYPE html>
<html>
<head>
<title>Assignment 1 Combinatorial Optimization</title>
</head>
<body>
<!-- -->
<!--UTILITY FUNCTIONS-->
<!-- -->

<div id='util_functions_div_id'>

<!-- -->
<!-- -->
<script>
function roundString(value, decimals)
{
	// adjusted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round
	
	// convert to number
	value = +value;
	decimals = +decimals;
	
	// check
	if( isNaN(value) || !(typeof decimals === 'number' && decimals % 1 === 0) )
	{
		return NaN;
	}

	// check negative
	var isNegative = value < 0;
	if( isNegative )
	{
		value = -value;
	}

	if (typeof decimals === 'undefined' || decimals === 0)
	{
		value = Math.round(value);
	}
	else
	{
		value = +(Math.round(+(value + 'e+' + decimals)) + 'e-' + decimals);
	}
	
	// handle negative
	if( isNegative )
	{
		value = -value;
	}
	
	// convert to string
	value = value.toString();
	return value;
}
</script>

<!-- -->
<!-- -->
<script>
function updateTextAreaAndLabel( fromTextAreaId, toTextAreaID, labelID, qNumRows, qNumCols, decimals )
{
	// get txt
	var txtArea = document.getElementById( fromTextAreaId );
	var rawTxt = txtArea.value;
	
	// convert to csv format
	var lines = rawTxt.replace(/(\r\n)/g,';').replace(/[\r\n]/g,';').replace(/[ \t]/g,',');
	
	// split each line
	var arrayLines = lines.split(';');
	
	// detected dimension
	var numRows = arrayLines.length;
	var numCols = 1 + (arrayLines[0].match(/,/g)||[]).length;
	
	// init
	var success = true;
	var failIncorrectDimensions = ( numRows <= 0 ) || ( numRows != qNumRows ) || ( numCols <= 0 ) || ( numCols != qNumCols );
	var failInconsistentDimensions = false;
	var failValues = false;
	
	// parse including round
	var currentNumCols = 0;
	for( var i=0; i < arrayLines.length; i++ )
	{
		// check dimension
		currentNumCols = 1 + (arrayLines[i].match(/,/g)||[]).length;
		if( currentNumCols != numCols )
		{
			failInconsistentDimensions = true;
		}
		
		// insert 0's if needed
		if( arrayLines[i].length == 0 )
		{
			arrayLines[i] = '0';
		}
		else
		{
			arrayLines[i] = arrayLines[i].replace(/^,/g, '0,').replace(/,$/g, ',0').replace(/,(?=,)/g, ',0');
		}
		
		// convert each element to number and round, then convert back
		var arrayElems = arrayLines[i].split(',');
		for( var j=0; j < arrayElems.length; j++ )
		{
			arrayElems[j] = roundString( arrayElems[j], decimals );
			
			if( isNaN(arrayElems[j]) )
			{
				failValues = true;
			}
		}
		
		// combine and store new string
		arrayLines[i] = arrayElems.join(',');
	}
	
	// combine using newline instead of ; for readability
	lines = arrayLines.join('\n');
	
	// successful?
	success = (success && !failIncorrectDimensions && !failInconsistentDimensions && !failValues );
	
	// make new label
	var newLabel = '';
	if( success )
	{
		newLabel += '<font color="green"><b>Success! Detected a matrix of size ' + numRows + ' x ' + numCols + '.</b></font>';
	}
	else
	{
		newLabel += '<font color="red"><b>Failure!';
		if( failInconsistentDimensions )
		{
			newLabel += ' Inconsistent dimensions detected!';
		}
		else
		{
			if( failIncorrectDimensions )
			{
				newLabel += ' Incorrect dimensions detected (detected a matrix of size ' + numRows + ' x ' + numCols + ')!';
			}
		}
		if( failValues )
		{
			newLabel += ' Invalid values detected!';
		}
		newLabel += '</b></font>';
	}
	
	// set textarea
	var resultTxtArea = document.getElementById( toTextAreaID );
	resultTxtArea.value = lines;
	
	// set label
	var resultLabel = document.getElementById( labelID );
	resultLabel.innerHTML = newLabel;
}
</script>

<!-- -->
<!-- -->
<script>
function getFormElement()
{
	var elem = document.getElementById( 'util_functions_div_id' ).parentElement;
	return elem;
}
</script>

<!-- -->
<!-- -->
<script>
function makeQuestionNumber()
{
	if( typeof( makeQuestionNumber.num ) == 'undefined' )
	{
		makeQuestionNumber.num = 0;
	}
	
	++makeQuestionNumber.num;
	
	return makeQuestionNumber.num;
}
</script>

<!-- -->
<!-- -->
<script>
function makeQuestionLabel( qnum, qlabel )
{
	var label = 'Question ' + qnum + ':<br>' + qlabel;
	return label;
}
</script>

<!-- -->
<!-- -->
<script>
function makeQuestionName( qtype, qauto, qnum, qname )
{
	var name = '_' + qtype;
	if( qauto )
	{
		name += '_auto';
	}
	else
	{
		name += '_manual';
	}
	name += '_question_' + qnum + '_' + qname;
	return name;
}
</script>

<!-- -->
<!-- -->
<script>
function makeNumberQuestionName( qtype, qauto, qnum, qdecimals, qname )
{
	var name = '_' + qtype;
	if( qauto )
	{
		name += '_auto';
	}
	else
	{
		name += '_manual';
	}
	name += '_decimals_' + qdecimals;
	name += '_question_' + qnum + '_' + qname;
	return name;
}
</script>

<!-- -->
<!-- -->
<script>
function makeQuestionId( name )
{
	var id = name + '_id_';
	return id;
}
</script>

<!-- -->
<!-- -->
<script>
function makeLabelElement( label, for_id, own_id )
{
	var content = '<label';
	
	if( typeof( for_id ) != 'undefined' )
	{
		content += ' for=' + for_id;
	}
	
	if( typeof( own_id ) != 'undefined' )
	{
		content += ' id=' + own_id;
	}
	content += '>';
	
	content += '<font color="black"><b>' + label + '</b></font></label>';
	return content;
}
</script>

<!-- -->
<!-- -->
<script>
function makeNumberQuestionElement( qauto, qlabel, qname, value, min, max, decimals, width )
{
	var qnum = makeQuestionNumber();
	var label = makeQuestionLabel( qnum, qlabel );
	var name = makeNumberQuestionName( 'num', qauto, qnum, decimals, qname );
	var id = makeQuestionId( name );
	var step = Math.pow( 10, -decimals );
	
	var content = '';
	content += makeLabelElement( label, id );
	content += '<br>';
	content += makeLabelElement( 'If needed, round your answer to ' + decimals + ' decimal places.', id );
	content += '<br>';
	content += '<input type="number" id=' + id + ' name=' + name + ' value=' + value + ' min=' + min + ' max=' + max + ' step=' + step + ' style="background-color:#D2D2D2;width:' + width + 'em" required="true" />';
	content += '<br><br>';
	
	var elem = getFormElement();
	elem.innerHTML += content;
}
</script>

<!-- -->
<!-- -->
<script>
function makeMatrixQuestionElement( qauto, qlabel, qname, numRows, numCols, decimals, width )
{
	var qnum = makeQuestionNumber();
	var label = makeQuestionLabel( qnum, qlabel );
	var name = makeNumberQuestionName( 'numarea', qauto, qnum, decimals, qname );
	var id = makeQuestionId( name );
	var shadowID = id + '_shadow';
	var labelID = id + '_label';
	
	var content = '';
	content += makeLabelElement( label, shadowID );
	content += '<br>';
	content += makeLabelElement( 'Your answer should be a numeric ' + numRows + ' x ' + numCols + ' matrix. Your answer will be automatically rounded to ' + decimals + ' decimal places.', shadowID );
	content += '<br>';
	content += '<textarea id=' + shadowID + ' oninput="updateTextAreaAndLabel(\'' + shadowID + '\',\'' + id + '\',\'' + labelID + '\',' + numRows + ',' + numCols + ',' + decimals + ')" style="background-color:#D2D2D2;width:' + width + 'em;height:' + width + 'em" required="true"></textarea>';
	content += '<br>';
	content += '<input type="button" value="Parse" onclick="updateTextAreaAndLabel(\'' + shadowID + '\',\'' + id + '\',\'' + labelID + '\',' + numRows + ',' + numCols + ',' + decimals + ')">';
	content += '<br>';
	content += makeLabelElement( 'This is the (read-only) parsed result that will be submitted:', id );
	content += '<br>';
	content += '<textarea id=' + id + ' name=' + name + ' style="background-color:#D2D2D2;width:' + width + 'em;height:' + width + 'em" readonly="true" required="true"></textarea>';
	content += '<br>';
	content += makeLabelElement( '', id, labelID );
	content += '<br><br>';
	
	var elem = getFormElement();
	elem.innerHTML += content;
}
</script>

<!-- -->
<!-- -->
<script>
function makeTextQuestionElement( qauto, qlabel, qname, width )
{
	var qnum = makeQuestionNumber();
	var label = makeQuestionLabel( qnum, qlabel );
	var name = makeQuestionName( 'txt', qauto, qnum, qname );
	var id = makeQuestionId( name );
	
	var content = '';
	content += makeLabelElement( label, id );
	content += '<br>';
	content += '<input type="text" id=' + id + ' name=' + name + ' style="background-color:#D2D2D2;width:' + width + 'em" required="true" />';
	content += '<br><br>';
	
	var elem = getFormElement();
	elem.innerHTML += content;
}
</script>

<!-- -->
<!-- -->
<script>
function makeTextAreaQuestionElement( qauto, qlabel, qname, width )
{
	var qnum = makeQuestionNumber();
	var label = makeQuestionLabel( qnum, qlabel );
	var name = makeQuestionName( 'txtarea', qauto, qnum, qname );
	var id = makeQuestionId( name );
	
	var content = '';
	content += makeLabelElement( label, id );
	content += '<br>';
	content += '<textarea id=' + id + ' name=' + name + ' style="background-color:#D2D2D2;width:' + width + 'em;height:' + width + 'em" required="true"></textarea>';
	content += '<br><br>';
	
	var elem = getFormElement();
	elem.innerHTML += content;
}
</script>

<!-- -->
<!-- -->
<script>
function makeMCQuestionElement( qauto, qlabel, qname )
{
	var qnum = makeQuestionNumber();
	var label = makeQuestionLabel( qnum, qlabel );
	var name = makeQuestionName( 'mc', qauto, qnum, qname );
	var id = makeQuestionId( name );
	
	var content = '';
	content += makeLabelElement( label );
	content += '<br>';
	content += '<div class="row" >';
	
	for(i = 3; i < arguments.length; i++)
	{
		var mcNum = i - 2;
		var mcId = id + '__ans_' + mcNum;
		var mcLabel = arguments[i];
		var mcValue = '"' + mcLabel + '"';
		
		content += '<input type="radio" id=' + mcId + ' name=' + name + ' value=' + mcValue;
		if( i == (arguments.length - 1) )
		{
			content += ' checked="true"';
		}
		content += ' />';
		
		content += makeLabelElement( mcLabel, mcId );
		content += '<br>';
	}
	
	content += '</div>';
	content += '<br>';
	
	var elem = getFormElement();
	elem.innerHTML += content;
}
</script>

</div>

<h1>Answers</h1>
<!-- -->
<!--INSTRUCTIONS-->
<!-- -->
INSTRUCTIONS
<hr>
For the numerical questions:
<ol>
	<li>Use a dot "." as decimal mark.
	<li>Round your answer to the listed number of decimals if needed.
</ol>
<br>
For the questions where the solution must be stated:
<ol>
	<li>Each space, tab, and comma is interpreted as an element delimiter.
	<li>Each newline and semicolon is interpreted as a row delimiter.
	<li>Empty elements are set to zero.
	<li>Direct copy-paste from Aimms is therefore supported.
	<li>Alternatively, state your answer in csv format.
</ol>
<br>
For the multiple-choice questions:
<ol>
<li>Choose the most complete correct answer.
</ol>
<br>
<b>Important:
<ol>
	<li>You cannot save your answers, so prepare and keep a local copy of your answers.
	<li>You can check your parsed answers in the Autolab output.
	<li>Until the official grading, your score is either 0% or 100%
	<li>A score of 100% indicates that your answers are parsed correctly. After the deadline, your answers will be graded.
	<li>A score of 0% indicates that your answers cannot be parsed correctly. Contact the staff member responsible for grading the assignment.
	<li>Ensure that both group members have confirmed their membership if working together with a partner
</ol>
</b>
<br>
<br>
<!-- -->
<!--SMALL IP-->
<!-- -->
<hr>
SMALL IP
<hr>

<script>
makeNumberQuestionElement( true, 'For the small instance, state the optimal IP objective value.', 'ip_val_small', 0, -Infinity, Infinity, 2, 7 );
</script>

<script>
makeMatrixQuestionElement( false, 'For the small instance, state the optimal IP solution as a column vector.', 'ip_sol_small', 5, 1, 2, 10 );
</script>

<!-- -->
<!--LARGE IP-->
<!-- -->
<hr>
LARGE IP
<hr>

<script>
makeNumberQuestionElement( true, 'For the large instance, state the optimal IP objective value.', 'ip_val_large', 0, -Infinity, Infinity, 2, 7 );
</script>

<script>
makeMatrixQuestionElement( false, 'For the large instance, state the optimal IP solution as a column vector.', 'ip_sol_large', 210, 1, 2, 10 );
</script>

<script>
makeNumberQuestionElement( false, 'For the large instance, state the running time needed to solve the IP to optimality.', 'ip_time_large', 0, 0, Infinity, 2, 7 );
</script>

<script>
makeNumberQuestionElement( false, 'For the large instance, state the number of nodes needed to solve the IP to optimality.', 'ip_nodes_large', 0, 0, Infinity, 0, 7 );
</script>


<!-- -->
<!--LARGE LP-->
<!-- -->
<hr>
LARGE LP
<hr>

<script>
makeNumberQuestionElement( true, 'For the large instance, state the optimal LP relaxation objective value.', 'lp_val_large', 0, -Infinity, Infinity, 2, 7 );
</script>

<script>
makeNumberQuestionElement( false, 'For the large instance, state the running time needed to solve the LP relaxation to optimality.', 'lp_time_large', 0, 0, Infinity, 2, 7 );
</script>
               

<!-- -->
<!--THEORY-->
<!-- -->
<hr>
THEORY
<hr>

<script>
makeMCQuestionElement( true, 'In general for this problem, the solution of the LP relaxation is:', 'feas', 'Always infeasible for the IP problem.', 'Always feasible for the IP problem.', 'Always potentially feasible for the IP problem.', 'None of the above.' );
</script>

<script>
makeMCQuestionElement( true, 'In general for this problem, the optimal objective value of the LP relaxation is:', 'value', 'Equal to the optimal IP objective value.', 'A lower bound for the optimal IP objective value.', 'An upper bound for the optimal IP objective value.', 'Unrelated to the optimal IP objective value.', 'None of the above.' );
</script>

<script>
makeMCQuestionElement( true, 'In general for this problem, the running time needed to solve the LP relaxation is:', 'time', 'Approximately equal to the running time needed for the IP problem.', 'Significantly lower than the running time needed for the IP problem.', 'Significantly higher than the running time needed for the IP problem.', 'None of the above.' );
</script>
</body></html>
